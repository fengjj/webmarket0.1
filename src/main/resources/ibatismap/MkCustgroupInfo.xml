<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap 
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">


<sqlMap namespace="MkCustgroupInfo">
	<sql id="select-all-column">
		SELECT
		cust_group_id AS custGroupId,
		cust_group_name AS custGroupName,
		cust_group_desc AS custGroupDesc,
		cust_num AS custNum,
		cust_type AS custType,
		start_date AS startDate,
		end_date AS endDate,
		choice_code as choiceCode,
		status_code AS statusCode,
		oper_no AS operNo,
		oper_name AS operName,
		DATE_FORMAT(oper_time,'%Y-%m-%d %H:%i:%s') AS operTime,
		region_code AS regionCode ,
		out_custgroup_id AS outGroupId,
		out_system_type AS 	outSysType	
		FROM mk_custgroup_info
	</sql>
	
	<sql id="where-all-condition">
		<dynamic prepend=" WHERE ">
			<isNotNull property="custGroupId" prepend="and">
				<isNotEmpty property="custGroupId">
					cust_group_id =
					#custGroupId#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custGroupName" prepend="and">
				<isNotEmpty property="custGroupName">
					cust_group_name =
					#custGroupName#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custGroupDesc" prepend="and">
				<isNotEmpty property="custGroupDesc">
					cust_group_desc =
					#custGroupDesc#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custNum" prepend="and">
				<isNotEmpty property="custNum">
					cust_num = #custNum#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="startDateStart" prepend="and">
				<isNotEmpty property="startDateStart">
					<![CDATA[ start_date >= #startDateStart# ]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="startDateEnd" prepend="and">
				<isNotEmpty property="startDateEnd">
					<![CDATA[ start_date <= #startDateEnd# ]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="endDateStart" prepend="and">
				<isNotEmpty property="endDateStart">
					<![CDATA[ end_date >= #endDateStart# ]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="endDateEnd" prepend="and">
				<isNotEmpty property="endDateEnd">
					<![CDATA[ end_date <= #endDateEnd# ]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="statusCode" prepend="and">
				<isNotEmpty property="statusCode">
					status_code = #statusCode#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="operNo" prepend="and">
				<isNotEmpty property="operNo">
					oper_no = #operNo#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="operName" prepend="and">
				<isNotEmpty property="operName">
					oper_name = #operName#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="operTimeStart" prepend="and">
				<isNotEmpty property="operTimeStart">
					<![CDATA[ oper_time >= #operTimeStart# ]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="operTimeEnd" prepend="and">
				<isNotEmpty property="operTimeEnd">
					<![CDATA[ oper_time <= #operTimeEnd# ]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="regionCode" prepend="and">
				<isNotEmpty property="regionCode">
					region_code = #regionCode#
				</isNotEmpty>
			</isNotNull>
		</dynamic>
	</sql>
	
	
	<!--全表查询  -->
	<select id="selectMkCustgroupInfo" parameterClass="java.util.Map"
		resultClass="java.util.HashMap">
		<include refid="select-all-column" />
		<include refid="where-all-condition" />
		order by cust_group_id desc
	</select>
	<select id="selectMkCustGroupInfoCount" parameterClass="java.util.Map" resultClass="java.util.HashMap" >
		select count(1) as count from mk_custgroup_info
		<include refid="where-all-condition" />
	</select>
	<!--根据id查询  -->
	<select id="selectMkCustgroupInfoById" parameterClass="java.lang.String"
		resultClass="java.util.HashMap">
		<include refid="select-all-column" />
		where cust_group_id = #custGroupId#
	</select>

	<!-- 插入 -->
	<insert id="insertMkCustgroupInfo" parameterClass="java.util.Map">
		<![CDATA[
		INSERT INTO mk_custgroup_info
		]]>
		<dynamic prepend=" (  ">
			<isNotNull property="custGroupId" prepend=",">
				<isNotEmpty property="custGroupId">
					cust_group_id
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custGroupName" prepend=",">
				<isNotEmpty property="custGroupName">
					cust_group_name
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custGroupDesc" prepend=",">
				<isNotEmpty property="custGroupName">
					cust_group_desc
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custNum" prepend=",">
				<isNotEmpty property="custNum">
					cust_num
				</isNotEmpty>
			</isNotNull>
			<isNotNull>
				<isNotEmpty property="custType" prepend=",">
					cust_type
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="startDate" prepend=",">
				<isNotEmpty property="startDate">
					start_date
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="endDate" prepend=",">
				<isNotEmpty property="endDate">
					end_date
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="statusCode" prepend=",">
				<isNotEmpty property="statusCode">
					status_code
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="operNo" prepend=",">
				<isNotEmpty property="operNo">
					oper_no
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="operName" prepend=",">
				<isNotEmpty property="operName">
					oper_name
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="operTime" prepend=",">
				<isNotEmpty property="operTime">
					oper_time
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="regionCode" prepend=",">
				<isNotEmpty property="regionCode">
					region_code
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="choiceCode" prepend=",">
				<isNotEmpty property="choiceCode">
					choice_code
				</isNotEmpty>
			</isNotNull>
		</dynamic>
		<dynamic prepend=" ) VALUES (  ">
			<isNotNull property="custGroupId" prepend=",">
				<isNotEmpty property="custGroupId">
					#custGroupId#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custGroupName" prepend=",">
				<isNotEmpty property="custGroupName">
					#custGroupName#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custGroupDesc" prepend=",">
				<isNotEmpty property="custGroupDesc">
					#custGroupDesc#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custNum" prepend=",">
				<isNotEmpty property="custNum">
					#custNum#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custType" prepend=",">
				<isNotEmpty property="custType">
					#custType#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="startDate" prepend=",">
				<isNotEmpty property="startDate">
					#startDate#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="endDate" prepend=",">
				<isNotEmpty property="endDate">
					#endDate#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="statusCode" prepend=",">
				<isNotEmpty property="statusCode">
					#statusCode#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="operNo" prepend=",">
				<isNotEmpty property="operNo">
					#operNo#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="operName" prepend=",">
				<isNotEmpty property="operName">
					#operName#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="operTime" prepend=",">
				<isNotEmpty property="operTime">
					#operTime#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="regionCode" prepend=",">
				<isNotEmpty property="regionCode">
					#regionCode#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="choiceCode" prepend=",">
				<isNotEmpty property="choiceCode">
					#choiceCode#
				</isNotEmpty>
			</isNotNull>
		</dynamic>
		)
	</insert>
	
	<!-- 根据id修改 -->
	<update id="updateMkCustgroupInfoById" parameterClass="java.util.Map">
		UPDATE mk_custgroup_info
		<dynamic prepend=" SET ">
			<isNotNull property="custGroupName" prepend=",">
				cust_group_name = #custGroupName#
			</isNotNull>
			<isNotNull property="custGroupDesc" prepend=",">
				cust_group_desc = #custGroupDesc#
			</isNotNull>
			<isNotNull property="custNum" prepend=",">
				cust_num =
				#custNum#
			</isNotNull>
			<isNotNull property="startDate" prepend=",">
				start_date = #startDate#
			</isNotNull>
			<isNotNull property="endDate" prepend=",">
				end_date =
				#endDate#
			</isNotNull>
			<isNotNull property="statusCode" prepend=",">
				status_code = #statusCode#
			</isNotNull>
			<isNotNull property="operNo" prepend=",">
				oper_no =
				#operNo#
			</isNotNull>
			<isNotNull property="operName" prepend=",">
				oper_name
				= #operName#
			</isNotNull>
			<isNotNull property="operTime" prepend=",">
				oper_time
				= #operTime#
			</isNotNull>
			<isNotNull property="regionCode" prepend=",">
				region_code = #regionCode#
			</isNotNull>
		</dynamic>
		where cust_group_id = #custGroupId#
	</update>
	
	<!-- 根据id删除 -->
	<delete id="deleteMkCustgroupInfoById" parameterClass="java.util.Map">
		delete from mk_custgroup_info 
		where cust_group_id = #custGroupId#
	</delete>
	<!-- 事件策划客户群查询 -->
	<select id="selectCustGroupForEvent" parameterClass="java.util.Map"
		resultClass="java.util.HashMap">
		select
		a.cust_group_id as custGroupId,
		a.cust_group_name as custGroupName,
		a.choice_code as choiceCode,
		a.cust_num as custNum,
		a.cust_group_desc custGroupDesc
		from mk_custgroup_info a
		where a.choice_code in(2,3)
		<isNotNull property="custGroupId">
			<isNotEmpty property="custGroupId">
				and
				a.cust_group_id=#custGroupId#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="custGroupName">
			<isNotEmpty property="custGroupName">
				and a.cust_group_name like
				CONCAT('%',TRIM(#custGroupName#),'%')
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="operTimeStart">
			<isNotEmpty property="operTimeStart">
				<![CDATA[ and date_format(a.oper_time,'%Y%m%d') >= date_format(#operTimeStart#,'%Y%m%d') ]]>
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="operTimeEnd">
			<isNotEmpty property="operTimeEnd">
				<![CDATA[ and date_format(a.oper_time,'%Y%m%d') <= date_format(#operTimeEnd#,'%Y%m%d') ]]>
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="operNo" prepend="and">
			<isNotEmpty property="operNo">
				a.oper_no = trim(#operNo#)
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="operName" prepend="and">
			<isNotEmpty property="operName">
				a.oper_name like CONCAT('%',TRIM(#operName#),'%') 
			</isNotEmpty>
		</isNotNull>
		order by a.oper_time desc
	</select>
</sqlMap>
