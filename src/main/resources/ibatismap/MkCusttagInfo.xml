<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap 
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">


<sqlMap namespace="MkCusttagInfo">


	<sql id="select-all-column">
	SELECT
		cust_tag_id AS custTagId,
		cust_tag_name AS custTagName,
		cust_tag_desc AS custTagDesc,
		tag_type AS tagType,
		start_date AS startDate,
		end_date AS endDate,
		status_code AS statusCode,
		dict_code AS dictCode,
		parent_cust_tag_id AS parentCustTagId	
	FROM mk_custtag_info
	</sql>
	
	<sql id="where-all-condition">
	<dynamic prepend=" WHERE ">
			<isNotNull property="custTagId" prepend="and">
				<isNotEmpty property="custTagId">
					cust_tag_id = #custTagId#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custTagName" prepend="and">
				<isNotEmpty property="custTagName">
					cust_tag_name = #custTagName#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="custTagDesc" prepend="and">
				<isNotEmpty property="custTagDesc">
					cust_tag_desc = #custTagDesc#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="tagType" prepend="and">
				<isNotEmpty property="tagType">
					tag_type = #tagType#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="startDateStart" prepend="and">
				<isNotEmpty property="startDateStart">
					<![CDATA[ start_date >= #startDateStart# ]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="startDateEnd" prepend="and">
				<isNotEmpty property="startDateEnd">
					<![CDATA[ start_date <= #startDateEnd# ]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="endDateStart" prepend="and">
				<isNotEmpty property="endDateStart">
					<![CDATA[ end_date >= #endDateStart# ]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="endDateEnd" prepend="and">
				<isNotEmpty property="endDateEnd">
					<![CDATA[ end_date <= #endDateEnd# ]]>
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="statusCode" prepend="and">
				<isNotEmpty property="statusCode">
					status_code = #statusCode#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="dictCode" prepend="and">
				<isNotEmpty property="dictCode">
					dict_code = #dictCode#
				</isNotEmpty>
			</isNotNull>
			<isNotNull property="parentCustTagId" prepend="and">
				<isNotEmpty property="parentCustTagId">
					parent_cust_tag_id = #parentCustTagId#
				</isNotEmpty>
			</isNotNull>
	</dynamic>
	</sql>
	<select id="selectMkCusttagInfoById" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		<include refid="select-all-column"/>
		WHERE cust_tag_id = #custTagId#
	</select>

	<select id="selectMkCusttagInfo" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		<include refid="select-all-column"/>
		<include refid="where-all-condition"/>
	</select>
	
	<select id="selectMkCusttagInfoByKeyword" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		<include refid="select-all-column"/>
		WHERE parent_cust_tag_id IN
		(SELECT cust_tag_id FROM mk_custtag_info WHERE cust_tag_id IN
		(SELECT cust_tag_id FROM mk_custtag_info WHERE parent_cust_tag_id='0'))
		AND cust_tag_name LIKE concat('%',#custTagNameKeyword#,'%')
	</select>
	
	<insert id="insertMkCusttagInfo" parameterClass="java.util.Map">
	<![CDATA[
	INSERT INTO mk_custtag_info
	]]>
	<dynamic prepend=" (  ">
		<isNotNull property="custTagId" prepend=",">
			<isNotEmpty property="custTagId">
				cust_tag_id
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="custTagName" prepend=",">
			<isNotEmpty property="custTagName">
				cust_tag_name
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="custTagDesc" prepend=",">
			<isNotEmpty property="custTagDesc">
				cust_tag_desc
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="tagType" prepend=",">
			<isNotEmpty property="tagType">
				tag_type
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="startDate" prepend=",">
			<isNotEmpty property="startDate">
				start_date
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="endDate" prepend=",">
			<isNotEmpty property="endDate">
				end_date
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="statusCode" prepend=",">
			<isNotEmpty property="statusCode">
				status_code
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="dictCode" prepend=",">
			<isNotEmpty property="dictCode">
				dict_code
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="parentCustTagId" prepend=",">
			<isNotEmpty property="parentCustTagId">
				parent_cust_tag_id
			</isNotEmpty>
		</isNotNull>
		</dynamic>
	    <dynamic prepend=" ) VALUES (  ">
		<isNotNull property="custTagId" prepend=",">
			<isNotEmpty property="custTagId">
				#custTagId#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="custTagName" prepend=",">
			<isNotEmpty property="custTagName">
				#custTagName#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="custTagDesc" prepend=",">
			<isNotEmpty property="custTagDesc">
				#custTagDesc#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="tagType" prepend=",">
			<isNotEmpty property="tagType">
				#tagType#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="startDate" prepend=",">
			<isNotEmpty property="startDate">
				#startDate#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="endDate" prepend=",">
			<isNotEmpty property="endDate">
				#endDate#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="statusCode" prepend=",">
			<isNotEmpty property="statusCode">
				#statusCode#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="dictCode" prepend=",">
			<isNotEmpty property="dictCode">
				#dictCode#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="parentCustTagId" prepend=",">
			<isNotEmpty property="parentCustTagId">
				#parentCustTagId#
			</isNotEmpty>
		</isNotNull>
	</dynamic>
	
	)
	</insert>
	
	<update id="updateMkCusttagInfo" parameterClass="java.util.Map">
	UPDATE mk_custtag_info
	<dynamic prepend=" SET ">
		<isNotNull property="custTagId" prepend=",">
		    <isNotEmpty property="custTagId">
			    cust_tag_id = #custTagId#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="custTagName" prepend=",">
		    <isNotEmpty property="custTagName">
			    cust_tag_name = #custTagName#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="custTagDesc" prepend=",">
		    <isNotEmpty property="custTagDesc">
			    cust_tag_desc = #custTagDesc#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="tagType" prepend=",">
		    <isNotEmpty property="tagType">
			    tag_type = #tagType#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="startDate" prepend=",">
		    <isNotEmpty property="startDate">
			    start_date = #startDate#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="endDate" prepend=",">
		    <isNotEmpty property="endDate">
			    end_date = #endDate#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="statusCode" prepend=",">
		    <isNotEmpty property="statusCode">
			    status_code = #statusCode#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="dictCode" prepend=",">
		    <isNotEmpty property="dictCode">
			    dict_code = #dictCode#
			</isNotEmpty>
		</isNotNull>
		<isNotNull property="parentCustTagId" prepend=",">
		    <isNotEmpty property="parentCustTagId">
			    parent_cust_tag_id = #parentCustTagId#
			</isNotEmpty>
		</isNotNull>
	</dynamic>

	<include refid="where-all-condition"/>
	</update>
	
	<delete id="deleteMkCusttagInfoById" parameterClass="java.util.Map">
	DELETE FROM mk_custtag_info
	WHERE cust_tag_id = #custTagId#
	</delete>

	<delete id="deleteMkCusttagInfo" parameterClass="java.util.Map">
	DELETE FROM mk_custtag_info
	<include refid="where-all-condition"/>
	</delete>
	
	<select id="selectMkCusttagInfoParam" parameterClass="java.util.Map" resultClass="java.util.HashMap">
		<isEmpty property="S">
			SELECT
			cust_tag_id AS custTagId,
			cust_tag_name AS custTagName,
			cust_tag_desc AS custTagDesc,
			tag_type AS tagType,
			start_date AS startDate,
			end_date AS endDate,
			status_code AS statusCode,
			dict_code AS dictCode,
			parent_cust_tag_id AS parentCustTagId
		</isEmpty>
		<isNotEmpty property="S">
			SELECT $S$
		</isNotEmpty>
		 	FROM mk_custtag_info $W$
	</select>
</sqlMap>
